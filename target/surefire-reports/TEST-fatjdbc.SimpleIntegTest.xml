<?xml version="1.0" encoding="UTF-8" ?>
<testsuite tests="9" failures="0" name="fatjdbc.SimpleIntegTest" time="2.453" errors="1" skipped="4">
  <properties>
    <property name="java.runtime.name" value="OpenJDK Runtime Environment"/>
    <property name="java.vm.version" value="14.0.1+14"/>
    <property name="sun.boot.library.path" value="/usr/local/Cellar/openjdk/14.0.1/libexec/openjdk.jdk/Contents/Home/lib"/>
    <property name="maven.multiModuleProjectDirectory" value="/Users/michaelchang/privacy_proxy"/>
    <property name="java.vm.vendor" value="Oracle Corporation"/>
    <property name="java.vendor.url" value="https://openjdk.java.net/"/>
    <property name="guice.disable.misplaced.annotation.check" value="true"/>
    <property name="path.separator" value=":"/>
    <property name="java.vm.name" value="OpenJDK 64-Bit Server VM"/>
    <property name="user.country" value="US"/>
    <property name="sun.java.launcher" value="SUN_STANDARD"/>
    <property name="test" value="SimpleIntegTest"/>
    <property name="java.vm.specification.name" value="Java Virtual Machine Specification"/>
    <property name="user.dir" value="/Users/michaelchang/privacy_proxy"/>
    <property name="java.vm.compressedOopsMode" value="Zero based"/>
    <property name="java.runtime.version" value="14.0.1+14"/>
    <property name="os.arch" value="x86_64"/>
    <property name="java.io.tmpdir" value="/var/folders/9y/yz3lkkts2tx99jc422x7cxqr0000gq/T/"/>
    <property name="line.separator" value="
"/>
    <property name="java.vm.specification.vendor" value="Oracle Corporation"/>
    <property name="os.name" value="Mac OS X"/>
    <property name="classworlds.conf" value="/usr/local/Cellar/maven/3.6.3_1/libexec/bin/m2.conf"/>
    <property name="sun.jnu.encoding" value="UTF-8"/>
    <property name="java.library.path" value="/Users/michaelchang/Library/Java/Extensions:/Library/Java/Extensions:/Network/Library/Java/Extensions:/System/Library/Java/Extensions:/usr/lib/java:."/>
    <property name="maven.conf" value="/usr/local/Cellar/maven/3.6.3_1/libexec/conf"/>
    <property name="jdk.debug" value="release"/>
    <property name="java.class.version" value="58.0"/>
    <property name="java.specification.name" value="Java Platform API Specification"/>
    <property name="sun.management.compiler" value="HotSpot 64-Bit Tiered Compilers"/>
    <property name="os.version" value="10.14"/>
    <property name="library.jansi.path" value="/usr/local/Cellar/maven/3.6.3_1/libexec/lib/jansi-native"/>
    <property name="http.nonProxyHosts" value="local|*.local|169.254/16|*.169.254/16"/>
    <property name="user.home" value="/Users/michaelchang"/>
    <property name="user.timezone" value="America/Los_Angeles"/>
    <property name="file.encoding" value="UTF-8"/>
    <property name="java.specification.version" value="14"/>
    <property name="user.name" value="michaelalanchang"/>
    <property name="java.class.path" value="/usr/local/Cellar/maven/3.6.3_1/libexec/boot/plexus-classworlds-2.6.0.jar"/>
    <property name="java.vm.specification.version" value="14"/>
    <property name="sun.arch.data.model" value="64"/>
    <property name="sun.java.command" value="org.codehaus.plexus.classworlds.launcher.Launcher -Dtest=SimpleIntegTest test"/>
    <property name="java.home" value="/usr/local/Cellar/openjdk/14.0.1/libexec/openjdk.jdk/Contents/Home"/>
    <property name="user.language" value="en"/>
    <property name="java.specification.vendor" value="Oracle Corporation"/>
    <property name="java.vm.info" value="mixed mode, sharing"/>
    <property name="java.version" value="14.0.1"/>
    <property name="java.vendor" value="N/A"/>
    <property name="maven.home" value="/usr/local/Cellar/maven/3.6.3_1/libexec"/>
    <property name="file.separator" value="/"/>
    <property name="java.version.date" value="2020-04-14"/>
    <property name="java.vendor.url.bug" value="https://bugreport.java.com/bugreport/"/>
    <property name="sun.io.unicode.encoding" value="UnicodeBig"/>
    <property name="sun.cpu.endian" value="little"/>
    <property name="socksNonProxyHosts" value="local|*.local|169.254/16|*.169.254/16"/>
    <property name="ftp.nonProxyHosts" value="local|*.local|169.254/16|*.169.254/16"/>
  </properties>
  <testcase classname="fatjdbc.SimpleIntegTest" name="simpleQueryOnNonDefaultQuery" time="0.57">
    <error message="Error while executing SQL &quot;select * from views.public.web_site_partition&quot;: Schema &quot;VIEWS&quot; not found; SQL statement:
SELECT * FROM &quot;VIEWS&quot;.&quot;PUBLIC&quot;.&quot;WEB_SITE_PARTITION&quot; [90079-187]" type="java.sql.SQLException">java.sql.SQLException: Error while executing SQL &quot;select * from views.public.web_site_partition&quot;: Schema &quot;VIEWS&quot; not found; SQL statement:
SELECT * FROM &quot;VIEWS&quot;.&quot;PUBLIC&quot;.&quot;WEB_SITE_PARTITION&quot; [90079-187]
	at org.apache.calcite.avatica.Helper.createException(Helper.java:56)
	at org.apache.calcite.avatica.Helper.createException(Helper.java:41)
	at org.apache.calcite.avatica.AvaticaStatement.executeInternal(AvaticaStatement.java:163)
	at org.apache.calcite.avatica.AvaticaStatement.executeQuery(AvaticaStatement.java:227)
	at fatjdbc.SimpleIntegTest.simpleQueryOnNonDefaultQuery(SimpleIntegTest.java:123)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:252)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:141)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:112)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:189)
	at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:165)
	at org.apache.maven.surefire.booter.ProviderFactory.invokeProvider(ProviderFactory.java:85)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:115)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:75)
Caused by: java.lang.RuntimeException: Schema &quot;VIEWS&quot; not found; SQL statement:
SELECT * FROM &quot;VIEWS&quot;.&quot;PUBLIC&quot;.&quot;WEB_SITE_PARTITION&quot; [90079-187]
	at fatjdbc.PrivacyMetaImpl.propagate(PrivacyMetaImpl.java:1102)
	at fatjdbc.PrivacyMetaImpl.prepareAndExecute(PrivacyMetaImpl.java:472)
	at org.apache.calcite.avatica.AvaticaConnection.prepareAndExecuteInternal(AvaticaConnection.java:675)
	at org.apache.calcite.avatica.AvaticaStatement.executeInternal(AvaticaStatement.java:156)
	... 32 more
</error>
    <system-out>inside create meta
fatjdbc.PrivacyConnectionImpl@197d671
{}
setting policy
null
Null pointer exception
end of constructor in privacy meta impl
in query context
inside query context
{schemaFactory=catalog.json.SchemaFactory, json:/Users/michaelchang/privacy_proxy/target/test-classes/SimpleModel.json=, model={
  &quot;version&quot;: &quot;2.0&quot;,
  &quot;dataSources&quot;: [
    {
      &quot;name&quot;: &quot;CANONICAL&quot;,
      &quot;password&quot;: &quot;&quot;,
      &quot;factory&quot;: &quot;plugin.jdbc.JdbcFactory&quot;,
      &quot;type&quot;: &quot;H2&quot;,
      &quot;url&quot;: &quot;jdbc:h2:mem:SimpleTest;DB_CLOSE_DELAY=-1&quot;,
      &quot;username&quot;: &quot;sa&quot;
    },
    {
      &quot;name&quot;: &quot;VIEWS&quot;,
      &quot;password&quot;: &quot;&quot;,
      &quot;type&quot;: &quot;H2&quot;,
      &quot;factory&quot;: &quot;plugin.jdbc.JdbcFactory&quot;,
      &quot;url&quot;: &quot;jdbc:h2:mem:SimpleViews;DB_CLOSE_DELAY=-1&quot;,
      &quot;username&quot;: &quot;sa&quot;
    },
    {
      &quot;name&quot;: &quot;CUBES&quot;,
      &quot;password&quot;: &quot;&quot;,
      &quot;factory&quot;: &quot;plugin.jdbc.JdbcFactory&quot;,
      &quot;type&quot;: &quot;H2&quot;,
      &quot;url&quot;: &quot;jdbc:h2:mem:SimpleCubes;DB_CLOSE_DELAY=-1&quot;,
      &quot;username&quot;: &quot;sa&quot;
    }
  ],
  &quot;defaultDataSource&quot;:0
}
}
inside schema factory class
inside privacy factory
trying to initialize
class plugin.jdbc.H2Db
get schemas
getting connections
Creating statement
executing query
getting schema from result set query
finished building
iterating through rs
PUBLIC
about to finish building
get schema fromm result set
Trying to initialize2trying to initialize
class plugin.jdbc.H2Db
get schemas
getting connections
Creating statement
executing query
getting schema from result set query
finished building
iterating through rs
PUBLIC
about to finish building
get schema fromm result set
Trying to initialize2trying to initialize
class plugin.jdbc.H2Db
get schemas
getting connections
Creating statement
executing query
getting schema from result set query
get schema fromm result set
Trying to initialize2initializing parser factory
sql.ParserFactory@2e6a5539
Creating statement in privacymetimpl
in prepareAndExecute2 in privacymetaimpl
setting policy
fatjdbc.PrivacyJdbc41Factory$QuarkJdbc41DatabaseMetaData@53de625d
sql.ParserFactory@2e6a5539
in query context
inside query context
{schemaFactory=catalog.json.SchemaFactory, json:/Users/michaelchang/privacy_proxy/target/test-classes/SimpleModel.json=, model={
  &quot;version&quot;: &quot;2.0&quot;,
  &quot;dataSources&quot;: [
    {
      &quot;name&quot;: &quot;CANONICAL&quot;,
      &quot;password&quot;: &quot;&quot;,
      &quot;factory&quot;: &quot;plugin.jdbc.JdbcFactory&quot;,
      &quot;type&quot;: &quot;H2&quot;,
      &quot;url&quot;: &quot;jdbc:h2:mem:SimpleTest;DB_CLOSE_DELAY=-1&quot;,
      &quot;username&quot;: &quot;sa&quot;
    },
    {
      &quot;name&quot;: &quot;VIEWS&quot;,
      &quot;password&quot;: &quot;&quot;,
      &quot;type&quot;: &quot;H2&quot;,
      &quot;factory&quot;: &quot;plugin.jdbc.JdbcFactory&quot;,
      &quot;url&quot;: &quot;jdbc:h2:mem:SimpleViews;DB_CLOSE_DELAY=-1&quot;,
      &quot;username&quot;: &quot;sa&quot;
    },
    {
      &quot;name&quot;: &quot;CUBES&quot;,
      &quot;password&quot;: &quot;&quot;,
      &quot;factory&quot;: &quot;plugin.jdbc.JdbcFactory&quot;,
      &quot;type&quot;: &quot;H2&quot;,
      &quot;url&quot;: &quot;jdbc:h2:mem:SimpleCubes;DB_CLOSE_DELAY=-1&quot;,
      &quot;username&quot;: &quot;sa&quot;
    }
  ],
  &quot;defaultDataSource&quot;:0
}
, fun=standard,hive}
inside schema factory class
inside privacy factory
trying to initialize
class plugin.jdbc.H2Db
get schemas
getting connections
Creating statement
executing query
getting schema from result set query
finished building
iterating through rs
PUBLIC
about to finish building
get schema fromm result set
Trying to initialize2trying to initialize
class plugin.jdbc.H2Db
get schemas
getting connections
Creating statement
executing query
getting schema from result set query
finished building
iterating through rs
PUBLIC
about to finish building
get schema fromm result set
Trying to initialize2trying to initialize
class plugin.jdbc.H2Db
get schemas
getting connections
Creating statement
executing query
getting schema from result set query
get schema fromm result set
Trying to initialize2Creating statement in privacymetimpl
[CALL_CENTER, CATALOG_PAGE, CATALOG_RETURNS, CATALOG_SALES, CUSTOMER, CUSTOMER_ADDRESS, CUSTOMER_DEMOGRAPHICS, DATE_DIM, DBGEN_VERSION, HOUSEHOLD_DEMOGRAPHICS, INCOME_BAND, INVENTORY, ITEM, PROMOTION, REASON, SHIP_MODE, STORE, STORE_RETURNS, STORE_RETURNS_COMPUTED, STORE_SALES, STORE_SALES_CUBE, TIME_DIM, WAREHOUSE, WEB_PAGE, WEB_RETURNS, WEB_SALES, WEB_SITE, CUSTOMER_ADDRESS_PARTITION, WAREHOUSE_PARTITION, WEB_SALES_PARTITION, WEB_SITE_PARTITION]
sql.ParserFactory@2e6a5539
in query context
inside query context
{schemaFactory=catalog.json.SchemaFactory, json:/Users/michaelchang/privacy_proxy/target/test-classes/SimpleModel.json=, model={
  &quot;version&quot;: &quot;2.0&quot;,
  &quot;dataSources&quot;: [
    {
      &quot;name&quot;: &quot;CANONICAL&quot;,
      &quot;password&quot;: &quot;&quot;,
      &quot;factory&quot;: &quot;plugin.jdbc.JdbcFactory&quot;,
      &quot;type&quot;: &quot;H2&quot;,
      &quot;url&quot;: &quot;jdbc:h2:mem:SimpleTest;DB_CLOSE_DELAY=-1&quot;,
      &quot;username&quot;: &quot;sa&quot;
    },
    {
      &quot;name&quot;: &quot;VIEWS&quot;,
      &quot;password&quot;: &quot;&quot;,
      &quot;type&quot;: &quot;H2&quot;,
      &quot;factory&quot;: &quot;plugin.jdbc.JdbcFactory&quot;,
      &quot;url&quot;: &quot;jdbc:h2:mem:SimpleViews;DB_CLOSE_DELAY=-1&quot;,
      &quot;username&quot;: &quot;sa&quot;
    },
    {
      &quot;name&quot;: &quot;CUBES&quot;,
      &quot;password&quot;: &quot;&quot;,
      &quot;factory&quot;: &quot;plugin.jdbc.JdbcFactory&quot;,
      &quot;type&quot;: &quot;H2&quot;,
      &quot;url&quot;: &quot;jdbc:h2:mem:SimpleCubes;DB_CLOSE_DELAY=-1&quot;,
      &quot;username&quot;: &quot;sa&quot;
    }
  ],
  &quot;defaultDataSource&quot;:0
}
, fun=standard,hive}
inside schema factory class
inside privacy factory
trying to initialize
class plugin.jdbc.H2Db
get schemas
getting connections
Creating statement
executing query
getting schema from result set query
finished building
iterating through rs
PUBLIC
about to finish building
get schema fromm result set
Trying to initialize2trying to initialize
class plugin.jdbc.H2Db
get schemas
getting connections
Creating statement
executing query
getting schema from result set query
finished building
iterating through rs
PUBLIC
about to finish building
get schema fromm result set
Trying to initialize2trying to initialize
class plugin.jdbc.H2Db
get schemas
getting connections
Creating statement
executing query
getting schema from result set query
get schema fromm result set
Trying to initialize2catalog nameCANONICAL
catalog nameCUBES
catalog namemetadata
catalog nameQUARK_METADATA
catalog nameVIEWS
is the connection metadata still null? fatjdbc.PrivacyJdbc41Factory$QuarkJdbc41DatabaseMetaData@53de625d
sql.ParserFactory@2e6a5539
in query context
inside query context
{schemaFactory=catalog.json.SchemaFactory, json:/Users/michaelchang/privacy_proxy/target/test-classes/SimpleModel.json=, model={
  &quot;version&quot;: &quot;2.0&quot;,
  &quot;dataSources&quot;: [
    {
      &quot;name&quot;: &quot;CANONICAL&quot;,
      &quot;password&quot;: &quot;&quot;,
      &quot;factory&quot;: &quot;plugin.jdbc.JdbcFactory&quot;,
      &quot;type&quot;: &quot;H2&quot;,
      &quot;url&quot;: &quot;jdbc:h2:mem:SimpleTest;DB_CLOSE_DELAY=-1&quot;,
      &quot;username&quot;: &quot;sa&quot;
    },
    {
      &quot;name&quot;: &quot;VIEWS&quot;,
      &quot;password&quot;: &quot;&quot;,
      &quot;type&quot;: &quot;H2&quot;,
      &quot;factory&quot;: &quot;plugin.jdbc.JdbcFactory&quot;,
      &quot;url&quot;: &quot;jdbc:h2:mem:SimpleViews;DB_CLOSE_DELAY=-1&quot;,
      &quot;username&quot;: &quot;sa&quot;
    },
    {
      &quot;name&quot;: &quot;CUBES&quot;,
      &quot;password&quot;: &quot;&quot;,
      &quot;factory&quot;: &quot;plugin.jdbc.JdbcFactory&quot;,
      &quot;type&quot;: &quot;H2&quot;,
      &quot;url&quot;: &quot;jdbc:h2:mem:SimpleCubes;DB_CLOSE_DELAY=-1&quot;,
      &quot;username&quot;: &quot;sa&quot;
    }
  ],
  &quot;defaultDataSource&quot;:0
}
, fun=standard,hive}
inside schema factory class
inside privacy factory
trying to initialize
class plugin.jdbc.H2Db
get schemas
getting connections
Creating statement
executing query
getting schema from result set query
finished building
iterating through rs
PUBLIC
about to finish building
get schema fromm result set
Trying to initialize2trying to initialize
class plugin.jdbc.H2Db
get schemas
getting connections
Creating statement
executing query
getting schema from result set query
finished building
iterating through rs
PUBLIC
about to finish building
get schema fromm result set
Trying to initialize2trying to initialize
class plugin.jdbc.H2Db
get schemas
getting connections
Creating statement
executing query
getting schema from result set query
get schema fromm result set
Trying to initialize2Creating statement in privacymetimpl
tables are fatjdbc.PrivacyResultSet@640f11a1
sql.ParserFactory@2e6a5539
in query context
inside query context
{schemaFactory=catalog.json.SchemaFactory, json:/Users/michaelchang/privacy_proxy/target/test-classes/SimpleModel.json=, model={
  &quot;version&quot;: &quot;2.0&quot;,
  &quot;dataSources&quot;: [
    {
      &quot;name&quot;: &quot;CANONICAL&quot;,
      &quot;password&quot;: &quot;&quot;,
      &quot;factory&quot;: &quot;plugin.jdbc.JdbcFactory&quot;,
      &quot;type&quot;: &quot;H2&quot;,
      &quot;url&quot;: &quot;jdbc:h2:mem:SimpleTest;DB_CLOSE_DELAY=-1&quot;,
      &quot;username&quot;: &quot;sa&quot;
    },
    {
      &quot;name&quot;: &quot;VIEWS&quot;,
      &quot;password&quot;: &quot;&quot;,
      &quot;type&quot;: &quot;H2&quot;,
      &quot;factory&quot;: &quot;plugin.jdbc.JdbcFactory&quot;,
      &quot;url&quot;: &quot;jdbc:h2:mem:SimpleViews;DB_CLOSE_DELAY=-1&quot;,
      &quot;username&quot;: &quot;sa&quot;
    },
    {
      &quot;name&quot;: &quot;CUBES&quot;,
      &quot;password&quot;: &quot;&quot;,
      &quot;factory&quot;: &quot;plugin.jdbc.JdbcFactory&quot;,
      &quot;type&quot;: &quot;H2&quot;,
      &quot;url&quot;: &quot;jdbc:h2:mem:SimpleCubes;DB_CLOSE_DELAY=-1&quot;,
      &quot;username&quot;: &quot;sa&quot;
    }
  ],
  &quot;defaultDataSource&quot;:0
}
, fun=standard,hive}
inside schema factory class
inside privacy factory
trying to initialize
class plugin.jdbc.H2Db
get schemas
getting connections
Creating statement
executing query
getting schema from result set query
finished building
iterating through rs
PUBLIC
about to finish building
get schema fromm result set
Trying to initialize2trying to initialize
class plugin.jdbc.H2Db
get schemas
getting connections
Creating statement
executing query
getting schema from result set query
finished building
iterating through rs
PUBLIC
about to finish building
get schema fromm result set
Trying to initialize2trying to initialize
class plugin.jdbc.H2Db
get schemas
getting connections
Creating statement
executing query
getting schema from result set query
get schema fromm result set
Trying to initialize2Creating statement in privacymetimpl
select * from views.public.web_site_partition
the table list is from [CALL_CENTER, CATALOG_PAGE, CATALOG_RETURNS, CATALOG_SALES, CUSTOMER, CUSTOMER_ADDRESS, CUSTOMER_DEMOGRAPHICS, DATE_DIM, DBGEN_VERSION, HOUSEHOLD_DEMOGRAPHICS, INCOME_BAND, INVENTORY, ITEM, PROMOTION, REASON, SHIP_MODE, STORE, STORE_RETURNS, STORE_RETURNS_COMPUTED, STORE_SALES, STORE_SALES_CUBE, TIME_DIM, WAREHOUSE, WEB_PAGE, WEB_RETURNS, WEB_SALES, WEB_SITE, CUSTOMER_ADDRESS_PARTITION, WAREHOUSE_PARTITION, WEB_SALES_PARTITION, WEB_SITE_PARTITION]
inside callback
cleared callback
in query context
inside query context
{schemaFactory=catalog.json.SchemaFactory, json:/Users/michaelchang/privacy_proxy/target/test-classes/SimpleModel.json=, model={
  &quot;version&quot;: &quot;2.0&quot;,
  &quot;dataSources&quot;: [
    {
      &quot;name&quot;: &quot;CANONICAL&quot;,
      &quot;password&quot;: &quot;&quot;,
      &quot;factory&quot;: &quot;plugin.jdbc.JdbcFactory&quot;,
      &quot;type&quot;: &quot;H2&quot;,
      &quot;url&quot;: &quot;jdbc:h2:mem:SimpleTest;DB_CLOSE_DELAY=-1&quot;,
      &quot;username&quot;: &quot;sa&quot;
    },
    {
      &quot;name&quot;: &quot;VIEWS&quot;,
      &quot;password&quot;: &quot;&quot;,
      &quot;type&quot;: &quot;H2&quot;,
      &quot;factory&quot;: &quot;plugin.jdbc.JdbcFactory&quot;,
      &quot;url&quot;: &quot;jdbc:h2:mem:SimpleViews;DB_CLOSE_DELAY=-1&quot;,
      &quot;username&quot;: &quot;sa&quot;
    },
    {
      &quot;name&quot;: &quot;CUBES&quot;,
      &quot;password&quot;: &quot;&quot;,
      &quot;factory&quot;: &quot;plugin.jdbc.JdbcFactory&quot;,
      &quot;type&quot;: &quot;H2&quot;,
      &quot;url&quot;: &quot;jdbc:h2:mem:SimpleCubes;DB_CLOSE_DELAY=-1&quot;,
      &quot;username&quot;: &quot;sa&quot;
    }
  ],
  &quot;defaultDataSource&quot;:0
}
, fun=standard,hive}
inside schema factory class
inside privacy factory
trying to initialize
class plugin.jdbc.H2Db
get schemas
getting connections
Creating statement
executing query
getting schema from result set query
finished building
iterating through rs
PUBLIC
about to finish building
get schema fromm result set
Trying to initialize2trying to initialize
class plugin.jdbc.H2Db
get schemas
getting connections
Creating statement
executing query
getting schema from result set query
finished building
iterating through rs
PUBLIC
about to finish building
get schema fromm result set
Trying to initialize2trying to initialize
class plugin.jdbc.H2Db
get schemas
getting connections
Creating statement
executing query
getting schema from result set query
get schema fromm result set
Trying to initialize2context schema is [CANONICAL, CUBES, metadata, QUARK_METADATA, VIEWS]
context default schema is [PUBLIC]
parsing sql
Executing inside Plan Executor
Executing queries inside PrivacyQueryExecutor
wef [PUBLIC]
wef2 [PUBLIC]
</system-out>
    <system-err>java.lang.NullPointerException
	at fatjdbc.PrivacyMetaImpl.set_policy(PrivacyMetaImpl.java:180)
	at fatjdbc.PrivacyMetaImpl.&lt;init&gt;(PrivacyMetaImpl.java:168)
	at fatjdbc.PrivacyDriver.createMeta(PrivacyDriver.java:93)
	at org.apache.calcite.avatica.AvaticaConnection.&lt;init&gt;(AvaticaConnection.java:121)
	at fatjdbc.PrivacyConnectionImpl.&lt;init&gt;(PrivacyConnectionImpl.java:33)
	at fatjdbc.PrivacyJdbc41Factory.newConnection(PrivacyJdbc41Factory.java:49)
	at fatjdbc.PrivacyJdbcFactory.newConnection(PrivacyJdbcFactory.java:70)
	at org.apache.calcite.avatica.UnregisteredDriver.connect(UnregisteredDriver.java:138)
	at fatjdbc.PrivacyDriver.connect(PrivacyDriver.java:136)
	at java.sql/java.sql.DriverManager.getConnection(DriverManager.java:677)
	at java.sql/java.sql.DriverManager.getConnection(DriverManager.java:189)
	at fatjdbc.SimpleIntegTest.setUpClass(SimpleIntegTest.java:45)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:24)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:252)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:141)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:112)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:189)
	at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:165)
	at org.apache.maven.surefire.booter.ProviderFactory.invokeProvider(ProviderFactory.java:85)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:115)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:75)
log4j:WARN No appenders could be found for logger (plugin.jdbc.JdbcDB).
log4j:WARN Please initialize the log4j system properly.
log4j:WARN See http://logging.apache.org/log4j/1.2/faq.html#noconfig for more info.
</system-err>
  </testcase>
  <testcase classname="fatjdbc.SimpleIntegTest" name="simpleInsertQueryOnNonDefaultQuery" time="0.571">
    <skipped/>
  </testcase>
  <testcase classname="fatjdbc.SimpleIntegTest" name="simpleAggregateSumQuery" time="0.25"/>
  <testcase classname="fatjdbc.SimpleIntegTest" name="simpleQueryOnDefaultWithNamespace" time="0.174"/>
  <testcase classname="fatjdbc.SimpleIntegTest" name="simpleQueryOnDefaultWithoutNamespaceAndDefaultSchema" time="0.153"/>
  <testcase classname="fatjdbc.SimpleIntegTest" name="simpleAggregateCountQuery" time="0.183"/>
  <testcase classname="fatjdbc.SimpleIntegTest" name="simplePrepareQueryOnNonDefaultQuery" time="0.184">
    <skipped/>
  </testcase>
  <testcase classname="fatjdbc.SimpleIntegTest" name="simpleQueryOnDefaultWithoutNamespace" time="0.184">
    <skipped message="Need to enable direct accessing schemas of default data source without namespace"/>
  </testcase>
  <testcase classname="fatjdbc.SimpleIntegTest" name="simpleExplainQueryOnNonDefaultQuery" time="0.184">
    <skipped/>
  </testcase>
</testsuite>